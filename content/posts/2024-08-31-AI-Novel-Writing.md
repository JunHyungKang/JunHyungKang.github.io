---
title: "AI 소설 쓰기 실험: 단일 API 콜부터 Agent 기반 접근까지"
date: "2024-08-31"
teaser: "생성형 AI를 활용해 장편 소설을 작성해보는 실험 과정과 LangGraph를 이용한 작가 Agent 구현 경험을 공유합니다."
tags:
  - AI
  - LLM
  - Novel Writing
  - LangGraph
  - Experiment
---

# 들어가며

안녕하세요, 오늘은 제가 최근에 진행한 흥미로운 실험에 대해 이야기해보려 합니다. 바로 생성형 AI를 활용해 소설과 같은 장문을 작성해본 경험입니다.
우리는 이제 일상적으로 AI 챗봇들과 대화를 나누며 놀라운 능력을 경험하고 있습니다. 하지만 저는 항상 이런 의문이 들었습니다. "과연 AI는 소설처럼 긴 글도 잘 쓸 수 있을까?"
이 질문에 대한 답을 찾아가는 과정에서, 저는 흥미로운 사실 하나를 발견했습니다. 여러 연구에서 AI 모델의 verbosity(장황함)가 사용자 경험 측면에서 반드시 좋은 것은 아니라는 점이었죠. 실제로 제가 실험해본 결과, 단순히 최대 토큰 수를 늘리는 것만으로는 AI가 일관성 있는 장문을 생성하기 어려워했습니다.

그러던 중 우연히 접한 한 연구 논문이 제 호기심을 자극했고, 이를 바탕으로 직접 실험을 해보기로 결심했습니다. 이 글에서는 그 과정과 결과, 그리고 이를 통해 얻은 인사이트를 여러분과 공유하고자 합니다.

# 단일 API 콜을 통한 소설 쓰기 테스트

AI가 얼마나 긴 소설을 쓸 수 있는지 테스트하기 위해, 저는 먼저 단일 API 콜을 사용하여 실험을 진행했습니다. 이를 위해 gpt4o-mini를 사용했습니다. 이 모델은 최대 16,384 토큰의 출력을 할 수 있어, 이론적으로는 매우 긴 텍스트를 생성할 수 있습니다.

### 사용한 프롬프트

실험을 위해 claude sonnet 3.5에게 부탁해서 만든 아래의 프롬프트를 사용했습니다:

```text
당신은 세계적으로 유명한 베스트셀러 작가입니다. 당신의 작품은 풍부한 세계관, 복잡한 캐릭터 발전, 그리고 흥미진진한 플롯으로 유명합니다. 지금 당신에게는 새로운 장편 소설을 쓸 기회가 주어졌습니다.

주제: {topic}

이 주제를 바탕으로 최대한 길고 상세한 소설을 써주세요. 다음 가이드라인을 따라주세요:

1. 풍부한 세계관 구축: 소설의 배경이 되는 세계를 상세히 묘사해주세요. 역사, 문화, 사회 구조, 기술 수준 등을 포함해주세요.
2. 다양하고 깊이 있는 캐릭터: 주요 등장인물들의 배경, 성격, 동기, 내적 갈등을 자세히 발전시켜주세요.
3. 복잡한 플롯 구조: 여러 개의 서브플롯을 포함한 복잡하고 흥미로운 이야기를 만들어주세요. 예상치 못한 반전도 포함시켜주세요.
4. 상세한 장면 묘사: 각 장면을 생생하게 묘사해주세요. 감각적인 세부 사항을 포함하여 독자가 그 장면 속에 있는 것처럼 느끼게 해주세요.
5. 다양한 문체 활용: 서술, 대화, 내적 독백, 회상 등 다양한 문체를 활용하여 이야기를 풍부하게 만들어주세요.
6. 테마와 상징: 소설 전반에 걸쳐 깊이 있는 테마와 상징을 발전시켜주세요.
7. 장편 구조: 소설을 여러 장(chapter)으로 나누어 구성해주세요. 각 장의 시작에는 간단한 요약이나 인용구를 넣어주세요.

이 가이드라인을 바탕으로, [주제]에 대한 최대한 길고 상세한 소설을 시작해주세요. 당신의 창의력을 최대한 발휘하여, 독자들이 몰입할 수 있는 풍부하고 흥미진진한 이야기를 만들어주세요.
```

### 실험 결과

실험은 Streamlit을 사용하여 간단한 웹 애플리케이션으로 구현하여 수행했습니다.
결과는 다소 실망스러웠습니다. 모델의 최대 출력 토큰수 16,384에 비해, 생성된 텍스트는 약 1,800 토큰에 그쳤습니다.

![실험 결과 1](/images/ai-novel-1.jpg)

### 결과 분석

이 실험 결과는 몇 가지 중요한 점을 시사합니다:

1. **모델의 한계**:모델이 큰 출력 토큰 제한를 가지고 있다고 해서, 그만큼의 텍스트를 한 번에 생성할 수 있는 것은 아닙니다. 모델은 여전히 비교적 짧은 응답을 생성하는 경향이 있습니다.
2. **일관성의 문제**: 연속적으로 대화를 이어서 텍스트 생성을 요청할 경우, 생성된 내용이 전체 이야기의 구조와 일관성을 유지하는 데 어려움을 겪을 수 있습니다.
3. **프롬프트의 영향**: 상세한 프롬프트를 제공했음에도 불구하고, 모델은 요청된 모든 요소를 충분히 발전시키지 못했습니다.

이러한 결과는 단일 API 콜만으로는 긴 소설을 쓰는 것이 현실적으로 어렵다는 것을 보여줍니다. 이는 더 복잡한 접근 방식, 예를 들어 여러 번의 API 콜을 연결하거나 사람의 개입을 통한 반복적인 과정이 필요할 수 있음을 시사합니다.

# 참고 연구 (LongWriter)

* Bai, Yushi, et al. "LongWriter: Unleashing 10,000+ Word Generation from Long Context LLMs." arXiv preprint arXiv:2408.07055 (2024).

처음에 언급했던 흥미로운 연구 논문의 내용을 간단히 보고 더 진행하려고 합니다. 이 연구는 제가 경험한 AI의 장문 생성 한계에 대한 이유를 설명해주는 동시에, 이를 극복할 수 있는 방법을 제시하고 있었습니다.

### 연구 개요

이 연구는 현재 긴 컨텍스트를 처리할 수 있는 대규모 언어 모델(LLM)들이 왜 긴 텍스트를 생성하는 데 어려움을 겪는지, 그리고 이를 어떻게 해결할 수 있는지에 대해 다루고 있습니다.

### 주요 사항

1. **현재 LLM의 한계**: 현재의 LLM들은 굉장히 긴 토큰의 입력을 처리할 수 있지만, 대부분 2,000 단어를 넘는 출력을 생성하는 데 어려움을 겪습니다.
2. **한계의 원인**: 이러한 한계는 모델 자체의 능력 부족이 아니라, 지도 학습 미세조정(SFT) 과정에서 사용된 데이터셋의 한계 때문입니다. 즉, 모델들은 긴 출력 예제를 충분히 학습하지 못했기 때문에 긴 텍스트를 생성하지 못하는 것입니다.
3. **해결책 - AgentWrite**: 연구팀은 AgentWrite라는 에이전트 기반 파이프라인을 개발했습니다. 이 시스템은 초장문 생성 작업을 여러 하위 작업으로 분해하여, 기존 LLM이 20,000 단어 이상의 일관된 출력을 생성할 수 있게 합니다.
    (나머지 사항으로 긴 출력 생성 모델의 학습을 위한 데이터셋, 모델 및 평가 벤치 마크도 공개하였습니다만 이 글에서는 그냥 closed model을 이용할 예정이기때문에 생략하였습니다.)

### 연구의 의의

이 연구는 현재의 LLM들이 이미 더 긴 출력을 생성할 잠재력을 가지고 있다는 점을 시사합니다. 필요한 것은 단지 모델 정렬 과정에서 더 긴 출력을 포함한 데이터를 사용하는 것뿐입니다. 이는 AI를 이용한 소설 쓰기와 같은 장문 생성 작업의 가능성을 크게 확장시킵니다.

### 나의 실험과의 연관성

이 연구 결과는 제가 경험한 단일 API 콜을 통한 소설 쓰기의 한계를 잘 설명해줍니다. gpt4o-mini가 1,800 토큰 정도의 텍스트만 생성한 것은, 모델이 훈련 과정에서 긴 출력 예제를 충분히 접하지 못했기 때문일 가능성이 높습니다.
그러나 제가 사용하는 것은 비공개 API 모델(GPT)이기 때문에, 연구팀처럼 새로운 데이터셋으로 모델을 재훈련시키는 방법은 사용할 수 없습니다. 대신, 이 연구에서 제안한 다른 핵심 아이디어인 '작업 분해' 방식에 주목했습니다.

![작업 분해 다이어그램](/images/ai-novel-2.jpg)

하지만 단순히 공개된 코드를 그대로 사용하는 것은 이 실험의 창의성과 재미를 반감시킬 수 있다고 생각했습니다. 그래서 저는 langgraph 프레임워크를 이용해서 나만의 독특한 작가 에이전트를 만들어보기로 결정했습니다. 이를 통해 여러 단계의 소설 쓰기 과정을 유기적으로 연결하고, 각 단계 사이의 상호작용을 더욱 정교하게 설계할 수 있을 것으로 기대합니다.

# 나만의 작가 Agent 만들기

### 실험 구조

![작가 Agent 워크플로우](/images/ai-novel-3.jpg)

이 다이어그램은 여러분이 구현한 소설 작성 Agent의 워크플로우를 보여줍니다. 각 단계를 간단히 설명하겠습니다:

1. `generate_topic_ideas`: 주어지는 독자층을 고려해서 소설의 주제 아이디어를 생성합니다.
2. `choose_topic`: 생성된 아이디어 중 하나를 선택합니다.
3. `create_outline`: 선택된 주제를 바탕으로 소설의 개요를 작성합니다.
4. `write_chapters`: 개요를 바탕으로 각 챕터를 작성합니다.
5. `evaluate_chapters`: 작성된 챕터들을 평가합니다.
6. `rewrite_chapters`: 평가 결과에 따라 챕터를 다시 씁니다.
7. `edit_book`: 2개씩 챕터를 이어서 확인하면서 수정할 부분을 수정해서 글을 확정합니다.

이 워크플로우는 소설 작성 과정을 체계적으로 분해하여 각 단계를 독립적으로 처리할 수 있게 해줍니다. 이는 앞서 언급한 연구 논문의 '작업 분해' 방식을 실제로 구현한 좋은 예시입니다.

### 실험 결과

우리의 AI 작가 Agent 실험은 흥미로운 결과를 보여주었습니다

![실험 결과 그래프](/images/ai-novel-4.jpg)

* **출력 길이의 차이**:
    동일한 주제에 대해 작성을 요청했을 때, 우리의 Agent 시스템은 기존 방식에 비해 약 **6~7배 길이**의 텍스트를 생성했습니다.
    이는 작업을 단계별로 분해하고 각 단계에 특화된 프롬프트를 사용한 결과로 보입니다.
* **내용의 일관성과 구조**:
    긴 텍스트임에도 불구하고, 생성된 내용은 전반적으로 일관성을 유지하며 잘 구조화되어 있었습니다.
    이는 outline 생성 단계와 각 챕터 작성 단계가 잘 연계되어 작동했음을 시사합니다.
* **품질 향상**:
    챕터 평가 및 재작성 단계를 통해 초기 버전보다 더 정제된 최종 결과물을 얻을 수 있었습니다.
    이는 AI의 자체 평가 능력과 수정 능력이 효과적으로 작동했음을 보여줍니다.
* **확장 가능성**:
    이번 실험 결과는 더 엄밀한 프롬프트 엔지니어링을 통해 실제 단편소설 정도와 유사한 길이의 텍스트 생성이 가능할 수 있음을 시사합니다.
    특히, 각 단계별로 더 세밀한 프롬프트 조정과 파라미터 최적화를 통해 성능을 크게 향상시킬 수 있을 것으로 예상됩니다.
* **한계와 과제**:
    긴 텍스트 생성에서 일관성을 완벽하게 유지하는 것은 여전히 과제로 남아있습니다.
    또한, 인간 작가의 독창성과 깊이 있는 통찰을 완전히 모방하는 데에는 한계가 있었습니다.

# 마무리 후기

이번 실험을 통해 우리는 AI를 활용한 소설 작성의 가능성과 한계를 탐색해보았습니다. LangGraph 프레임워크를 이용한 작가 Agent의 구현은 단순히 기존 출력의 한계를 극복하는 것을 넘어, AI 창작의 새로운 가능성을 보여주었습니다.
개인적으로는 이 프로젝트를 더욱 확장하여, 각 챕터마다 FLUX모델로 이미지를 생성하고 전체 동화를 텍스트 음성 변환(TTS) 모델과 연동하여 영상으로 제작하는 것까지 시도해볼 계획입니다. 이는 AI 기술이 단순히 텍스트 생성에 그치지 않고, 멀티미디어 콘텐츠 제작으로까지 확장될 수 있음을 보여줄 것입니다.

이러한 실험은 AI 기술의 발전이 창작 과정에 어떤 영향을 미칠 수 있는지, 그리고 인간과 AI의 협업이 어떤 새로운 가능성을 열어줄 수 있는지에 대한 흥미로운 통찰을 제공합니다. 앞으로 AI 기술이 더욱 발전함에 따라, 우리는 더 많은 혁신적인 창작 방식을 목격하게 될 것입니다. AI 시대의 창작은 이제 막 시작되었습니다. 우리 모두 이 흥미진진한 여정에 함께 참여해보는 것은 어떨까요?
